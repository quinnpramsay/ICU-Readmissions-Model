# -*- coding: utf-8 -*-
"""ICU-GCP-dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1qL2XnZWhaeO-BopF03qUcgxIXS4ZZzZd
"""

# Import libraries
import numpy as np
import os
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import matplotlib.path as path

# Make pandas dataframes prettier
from IPython.display import display, HTML

# Access data using Google BigQuery.
from google.colab import auth
from google.cloud import bigquery

auth.authenticate_user()

project_id='icu-readmissions-ai-project'
client = bigquery.Client(project=project_id)

# MIMIC-IV v3.1 dataset information
MIMIC_PROJECT = "physionet-data"
MIMIC_DATASET = "mimiciv_3_1_hosp"

print(f"\nConnected to project: {project_id}")
print(f"Querying MIMIC-IV v3.1 dataset: {MIMIC_PROJECT}.{MIMIC_DATASET}")

# ============================================================================
def list_tables():
    """List all tables in the MIMIC-IV v3.1 dataset"""
    dataset_ref = f"{MIMIC_PROJECT}.{MIMIC_DATASET}"
    tables = client.list_tables(dataset_ref)

    print(f"\n{'='*60}")
    print("Available tables in MIMIC-IV v3.1:")
    print(f"{'='*60}")

    table_list = []
    for table in tables:
        table_list.append(table.table_id)
        print(f"  - {table.table_id}")

    return table_list

tables = list_tables()